## Problem
[Problem 2 - Even Fibonacci Numbers](https://projecteuler.net/problem=2):

Each new term in the Fibonacci sequence is generated by adding the previous two terms. By starting with 1 and 2, the first 10 terms will be:
1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...
By considering the terms in the Fibonacci sequence whose values do not exceed four million, find the sum of the even-valued terms.


## Considerations

* The indices of numbers in the Fibonacci Sequence are standardised in [A000045](https://oeis.org/A000045) with F(0)=0, F(1)=1, F(2)=1, F(3)=2...
* From the above definition, the sequence is then 0, 1, 1, 2, 5, ... starting form index 0.
* The following observations on adding odd and even numbers are usefull to bear in mind:
 - Adding an even and an odd number produces an odd number.
 - Adding two even numbers produces an even number.
 - Adding two odd numbers produces an even number.
* From the obersvations above, and the beginning of the Fibonacci series, we can see that every third number will be even with indices that are multiples of 3.
* Good ressources on the Fibonacci Sequence are [Wikipedia](https://en.wikipedia.org/wiki/Fibonacci_sequence) and [Matworld.Wolfram](https://mathworld.wolfram.com/FibonacciNumber.html).


## Naive solution

Make a while-loop that generates three Fibonacci numbers, stores the even one, and continues untill the Fibonacci number exceeds the maximum.
The given solution implements this with a barebone ring-buffer and support-functions for my entertainment.

## Smart solution

To make a closed-form solution that does not depend on itteratively solving the problem, there are three sub-problems that must be solved:

1. Find a closed-form formula to calculate the largest index that gives a Fibonacci number lover than an upper bound (here 4'000'000).
2. Find a closed-form formula for calculating the sum of even Fibonacci numbers
3. Find a closed-form formula to calculate the Fibbonaci number of a given index N.

The third sub-problem arises from my solution to the second, and might not be strictly necessary given another implementation.

For sub-problem 1. and 3. [Wikipedia:Computation by rounding](https://en.wikipedia.org/wiki/Fibonacci_sequence#Computation_by_rounding) section presents two formulas for solving the issues. The advantage of them is that they are simple and easy to implement, a disadvantage is that they depend on somewhat expensive floating point calculations. Alternatives more complex integer formulas exists, atleast for sub-problem 3, but I have not analysed if they result in a significantly reduction in computational time or not.

To begin with a solution to the second sub-problem [Wikipedia:Combinatorial proofs](https://en.wikipedia.org/wiki/Fibonacci_sequence#Combinatorial_proofs) section presents the following formula for summing all Fibonacci numbers below some index N:
`sum_{n=1}^{N}(F_n) = F_{N+2} - 1`
This can be modified to sum all even Fibonacci numbers by applying a clever idea.
From the definition of the Fibonacci sequence, we have `F_{n+3} = F_{n+2} + F_{n+1}`. Summing these three Fibonacci numbers we get `F_{n+3} + F_{n+2} + F_{n+1} = F_{n+3} + (F_{n+2} + F_{n+1}) = F_{n+3} + F_{n+3} = 2*F_{n+3}`.
From this we can conclude that dividing a sum of Fibonacci numbers by two corresponds to summing every third entry, which corresponds to summing all even entries so long as we end the sum on an index that corresponds to an even-valued term. We thus have:
`sum_{n in even}^{N}(F_n) = (F_{N+2} - 1) / 2`
Credit for this trick goes to Euler Project user **Autumn** who, as far as I can tell, is the first to document this derivation.
